# Set the mod key
# Mod1: ALT
# Mod4: Win/CMD
set_from_resource $mod  i3.mod_primary    Mod1
set_from_resource $mod2 i3.mod_secondary  Mod4

# Use Mouse+$mod to drag floating windows to their wanted position
floating_modifier $mod

# Disable focusing a window on mouse hover over
focus_follows_mouse no

# Start a terminal
bindsym $mod+Return exec i3-sensible-terminal

# Kill focused window
bindsym $mod+Shift+q kill

# Start dmenu (a program launcher)
bindsym $mod+d exec --no-startup-id "rofi -show drun"
# Start a all-in-one rofi menu
bindsym $mod2+d exec --no-startup-id "rofi -combi-modi drun,window,ssh,run -show combi -modi combi"
# Start a open-window selector
bindsym $mod+Tab exec --no-startup-id "rofi -show window"

# Change focus
bindsym $mod+h focus left
bindsym $mod+j focus down
bindsym $mod+k focus up
bindsym $mod+l focus right

# Move focused window
bindsym $mod+Shift+h move left
bindsym $mod+Shift+j move down
bindsym $mod+Shift+k move up
bindsym $mod+Shift+l move right

# Set split mode to horizontal/vertical
bindsym $mod+m split h
bindsym $mod+n split v

# Enter fullscreen mode for the focused container
bindsym $mod+f fullscreen

# Change container layout (stacked, tabbed)
bindsym $mod+s layout stacking
bindsym $mod+t layout tabbed

# Toggle tiling / floating
bindsym $mod+Shift+f floating toggle

# Focus the parent container
bindsym $mod+a focus parent

# Focus the child container
bindsym $mod+Shift+a focus child

# Configure workspace names
set $w1 "1 "
set $w2 "2 "
set $w3 "3 "
set $w4 "4 "
set $w5 "5 "
set $w6 "6 "
set $w7 "7 "
set $w8 "8 "
set $w9 "9 "
set $w10 "10 "

# Define monitors
set $m1 primary
set_from_resource $m2 i3.monitor_2 "DP-1"

# Assign workspaces to monitors
workspace 1 output $m1
workspace 2 output $m2
workspace 3 output $m1
workspace 4 output $m2
workspace 5 output $m2
workspace 6 output $m2
workspace 7 output $m1
workspace 8 output $m2
workspace 9 output $m1
workspace 10 output $m1

# Switch to workspace n shorcuts
bindsym $mod+1 workspace number $w1
bindsym $mod+2 workspace number $w2
bindsym $mod+3 workspace number $w3
bindsym $mod+4 workspace number $w4
bindsym $mod+5 workspace number $w5
bindsym $mod+6 workspace number $w6
bindsym $mod+7 workspace number $w7
bindsym $mod+8 workspace number $w8
bindsym $mod+9 workspace number $w9
bindsym $mod+0 workspace number $w10

# Assign workspaces with their new names to monitors
workspace $w1 output $m1
workspace $w2 output $m2
workspace $w3 output $m1
workspace $w4 output $m2
workspace $w5 output $m2
workspace $w6 output $m2
workspace $w7 output $m1
workspace $w8 output $m2
workspace $w9 output $m1
workspace $w10 output $m1

# Force move all workspaces to their corresponding outputs
exec_always --no-startup-id i3-msg 'workspace number $w3'
exec_always --no-startup-id i3-msg 'workspace number $w4'
exec_always --no-startup-id i3-msg 'workspace number $w1'
exec_always --no-startup-id i3-msg 'workspace number $w2'
exec_always --no-startup-id i3-msg '\
    workspace number $w1; move workspace to output $m1; \
    workspace number $w2; move workspace to output $m2; \
    workspace number $w3; move workspace to output $m1; \
    workspace number $w4; move workspace to output $m2; \
    workspace number $w5; move workspace to output $m2; \
    workspace number $w6; move workspace to output $m2; \
    workspace number $w7; move workspace to output $m1; \
    workspace number $w8; move workspace to output $m2; \
    workspace number $w9; move workspace to output $m1; \
    workspace number $w10; move workspace to output $m1;'

# switch to neighbouring workspaces
bindsym $mod+Shift+Left workspace prev
bindsym $mod+Shift+Right workspace next

# Move focused container to workspace
bindsym $mod+Shift+1 move container to workspace number $w1
bindsym $mod+Shift+2 move container to workspace number $w2
bindsym $mod+Shift+3 move container to workspace number $w3
bindsym $mod+Shift+4 move container to workspace number $w4
bindsym $mod+Shift+5 move container to workspace number $w5
bindsym $mod+Shift+6 move container to workspace number $w6
bindsym $mod+Shift+7 move container to workspace number $w7
bindsym $mod+Shift+8 move container to workspace number $w8
bindsym $mod+Shift+9 move container to workspace number $w9
bindsym $mod+Shift+0 move container to workspace number $w10

# Reload the configuration file
bindsym $mod+Shift+c exec --no-startup-id <i3-refresh-script> reload

# Restart i3 inplace (preserves your layout/session, can be used to upgrade i3)
bindsym $mod+Shift+r exec --no-startup-id <i3-refresh-script> restart

# Screenshot control
bindsym --release $mod+$mod2+p	exec --no-startup-id <screenshot-script> -p ~/Pictures/screenshots -r
bindsym --release $mod+p		exec --no-startup-id <screenshot-script> -p ~/Pictures/screenshots -s

# Enable volume± and mute
bindsym XF86AudioRaiseVolume exec "amixer -q -D pulse sset Master 5%+ unmute"
bindsym XF86AudioLowerVolume exec "amixer -q -D pulse sset Master 5%- unmute"
bindsym XF86AudioMute exec "amixer -q -D pulse sset Master toggle"

# Enable Birghtness±
bindsym XF86MonBrightnessUp     exec light -A 5
bindsym XF86MonBrightnessDown   exec light -U 5

bindsym XF86KbdBrightnessUp     exec light -k -A 10
bindsym XF86KbdBrightnessDown   exec light -k -U 10

# Create a fast note
bindsym $mod+Shift+n exec i3-sensible-terminal -ls -title "i3-note" -e "note"

# Resize window (you can also use the mouse for that)
set $rs	15
mode "resize" {
    bindsym h resize shrink width $rs px or $rs ppt
    bindsym k resize grow height $rs px or $rs ppt
    bindsym j resize shrink height $rs px or $rs ppt
    bindsym l resize grow width $rs px or $rs ppt

    # same bindings, but for the arrow keys
    bindsym Left resize shrink width $rs px or $rs ppt
    bindsym Down resize grow height $rs px or $rs ppt
    bindsym Up resize shrink height $rs px or $rs ppt
    bindsym Right resize grow width $rs px or $rs ppt

    # back to normal: Enter or Escape
    bindsym Return mode "default"
    bindsym Escape mode "default"
}

bindsym $mod+r mode "resize"

# Create Log out, Reboot, Poweroff bindings
set $mode_system System (l) lock, (e) logout, (s) suspend, (h) hibernate, (r) reboot, (Shift+s) shutdown
mode "$mode_system" {
    bindsym l exec --no-startup-id <i3-exit-script> lock, mode "default"
    bindsym e exec --no-startup-id <i3-exit-script> logout, mode "default"
    bindsym s exec --no-startup-id <i3-exit-script> suspend, mode "default"
    bindsym h exec --no-startup-id <i3-exit-script> hibernate, mode "default"
    bindsym r exec --no-startup-id <i3-exit-script> reboot, mode "default"
    bindsym Shift+s exec --no-startup-id <i3-exit-script> shutdown, mode "default"

    # back to normal: Enter or Escape
    bindsym Return mode "default"
    bindsym Escape mode "default"
}
bindsym $mod+Shift+e mode "$mode_system"

# Layouting
for_window [class="^.*"] border pixel 0
gaps inner 8
smart_gaps on

# Window assignments
# call xprop on the command line and click the window you want to identiy. On 
# the output you can find the line
#   WM_CLASS(STRING) = "<instance_name>", "<class_name>"
# use this information to assign windows to workspaces
assign [class="Firefox"] $w1
assign [class="jetbrains-pycharm"] $w2
assign [class="Thunderbird"] $w8
assign [class="Slack"] $w8
assign [class="MineTime"] $w8
assign [class="GitKraken"] $w9

for_window [class="(?i)calculator"] floating enable
for_window [class="(?i)plexamp"] floating enable
for_window [title="^i3-note$"] floating enable

# Configure keyboard layout toggles
exec --no-startup-id setxkbmap us,de -option 'grp:alt_space_toggle'

# Make sure the display configuration is loaded properly
exec --no-startup-id autorandr --change

# Re-load the last wallpaper setting
exec --no-startup-id nitrogen --restore

# Launch the network applet
exec_always --no-startup-id nm-applet

# Program launches
exec_always --no-startup-id $HOME/.config/polybar/launch.sh

# Start composite window manager
exec --no-startup-id compton -b -d :0

# Disable automatic launching of deskop along with nautilus
exec --no-startup-id gsettings set org.gnome.desktop.background show-desktop-icons false

# make sure the gnome keyring is launched on login
exec --no-startup-id /usr/bin/gnome-keyring-daemon --start --components=secrets

